<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gd.gym.mapper.ReviewBoardMapper">
	<select id="selectReviewList"
			resultType="com.gd.gym.vo.Review">
		SELECT
			review_id reviewId,
			lecture_member_id lectureMemberId,
			review_title reviewTitle,
			review_score reviewScore,
			create_date createDate
		FROM
			review
	</select>
	
	<select id="selectReviewOne"
			parameterType="int"
			resultType="com.gd.gym.vo.Review">
		SELECT
			review_id reviewId,
			lecture_member_id lectureMemberId,
			review_title reviewTitle,
			review_content reviewContent,
			review_score reviewScore,
			create_date createDate
		FROM
			review
		WHERE
			review_id = #{reviewId}
	</select>
	
	<select id="selectReviewLikeCount"
			parameterType="int"
			resultType="Integer">
		SELECT
			COUNT(*)
		FROM
			review_like
		WHERE
			review_id = #{reviewId}
	</select>
	<select id="selectReviewLikeCheck"
			parameterType="int"
			resultType="Integer">
		SELECT
			COUNT(*)
		FROM
			review_like
		WHERE
			review_id = #{reviewId} AND member_id = #{memberId}
	</select>
	
	<insert id="insertReviewLike">
		INSERT INTO
			review_like(review_id, member_id, last_update)
		VALUES
			(#{reviewId}, #{memberId}, NOW())
	</insert>
	<delete id="deleteReviewLike">
		DELETE FROM
			review_like
		WHERE
			review_id = #{reviewId} AND member_id = #{memberId}
	</delete>
	<insert id="insertReview"
			parameterType="com.gd.gym.vo.Review">
		INSERT INTO
			review(lecture_member_id, review_title, review_content, review_score, create_date, last_update)
		VALUES
			(#{lectureMemberId}, #{reviewTitle}, #{reviewContent}, #{reviewScore}, NOW(), NOW())
	</insert>
	<select id="selectLectureMember"
			parameterType="int"
			resultType="Integer">
		SELECT
			lecture_member_id
		FROM
			lecture_member
		WHERE
			member_id = #{memberId}
	</select>
	<update id="updateReview">
		UPDATE
			review
		SET
			review_title = #{reviewTitle},
			review_content = #{reviewContent},
			review_score = #{reviewScore},
			last_update = NOW()
		WHERE
			review_id = #{reviewId}
			
	</update>
</mapper>